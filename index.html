<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2ecc71">
    <title>Contasoldi Widget</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            display: flex; 
            justify-content: center; 
            background-color: #f8f9fa; 
            margin: 0;
            padding: 20px;
        }
        .widget { 
            background: white; 
            padding: 20px; 
            border-radius: 25px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
            width: 100%; 
            max-width: 340px; 
        }
        h2 { text-align: center; color: #2c3e50; font-size: 1.5em; margin-bottom: 20px; }
        .categoria { 
            margin-bottom: 12px; 
            padding: 15px; 
            background: #ffffff; 
            border: 1px solid #f0f0f0;
            border-radius: 18px;
            display: flex;
            flex-direction: column;
        }
        .nome-categoria { 
            font-size: 0.75em; 
            color: #95a5a6; 
            text-transform: uppercase; 
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        .controlli { 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
        }
        button { 
            width: 50px; 
            height: 50px; 
            border-radius: 15px; 
            border: none; 
            background-color: #2ecc71; 
            color: white; 
            font-size: 22px; 
            font-weight: bold; 
            cursor: pointer;
            transition: transform 0.1s;
            -webkit-tap-highlight-color: transparent;
        }
        button:active { transform: scale(0.9); }
        button.meno { background-color: #e74c3c; }
        .valore { font-size: 1.3em; font-weight: bold; color: #34495e; }
        .totale-box { 
            text-align: center; 
            margin-top: 20px; 
            padding: 20px; 
            background: #2ecc71;
            border-radius: 18px;
            color: white;
        }
        .totale-label { display: block; font-size: 0.8em; text-transform: uppercase; opacity: 0.9; }
        .totale-cifra { font-size: 2.2em; font-weight: bold; }
    </style>
</head>
<body>

<div class="widget">
    <h2>I miei Risparmi</h2>

    <div class="categoria">
        <span class="nome-categoria">Banconote (10€)</span>
        <div class="controlli">
            <button class="meno" onclick="aggiorna('banconote', -10)">-</button>
            <span id="banconote" class="valore">0.00 €</span>
            <button onclick="aggiorna('banconote', 10)">+</button>
        </div>
    </div>

    <div class="categoria">
        <span class="nome-categoria">Monete (0.50€)</span>
        <div class="controlli">
            <button class="meno" onclick="aggiorna('monete', -0.5)">-</button>
            <span id="monete" class="valore">0.00 €</span>
            <button onclick="aggiorna('monete', 0.5)">+</button>
        </div>
    </div>

    <div class="categoria">
        <span class="nome-categoria">Monetine (0.05€)</span>
        <div class="controlli">
            <button class="meno" onclick="aggiorna('monetine', -0.05)">-</button>
            <span id="monetine" class="valore">0.00 €</span>
            <button onclick="aggiorna('monetine', 0.05)">+</button>
        </div>
    </div>

    <div class="totale-box">
        <span class="totale-label">Totale Generale</span>
        <span class="totale-cifra"><span id="totale">0.00</span> €</span>
    </div>
</div>

<script>
    // Caricamento dati salvati
    let dati = JSON.parse(localStorage.getItem('conteggioSoldi')) || {
        banconote: 0,
        monete: 0,
        monetine: 0
    };

    function aggiorna(tipo, variazione) {
        let nuovoValore = dati[tipo] + variazione;
        if (nuovoValore < 0) nuovoValore = 0;
        
        dati[tipo] = nuovoValore;
        localStorage.setItem('conteggioSoldi', JSON.stringify(dati));
        mostraDati();
    }

    function mostraDati() {
        document.getElementById('banconote').innerText = dati.banconote.toFixed(2) + " €";
        document.getElementById('monete').innerText = dati.monete.toFixed(2) + " €";
        document.getElementById('monetine').innerText = dati.monetine.toFixed(2) + " €";
        
        let somma = dati.banconote + dati.monete + dati.monetine;
        document.getElementById('totale').innerText = somma.toFixed(2);
    }

    // Esegui all'avvio e quando l'app torna in primo piano
    window.onload = mostraDati;
    window.addEventListener('focus', mostraDati);
</script>

</body>
</html>
